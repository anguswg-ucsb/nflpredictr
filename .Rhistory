odds_lst <- list()
i = 9
# rm(i)
odds_lst <- list()
logger::log_info("Vegas tbl {i}")
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table() %>%
dplyr::mutate(homeaway = if_else(row_number() %% 2 == 0, paste0("home_team"), "away_team"))
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
# vegas_url <- "https://vegas-odds.com/nfl/odds/"
# vegas_url <- "https://sportsbook.draftkings.com/leagues/football/nfl"
vegas_url <- "https://www.rotowire.com/betting/nfl/odds/week-1"
vegas_page <- rvest::read_html(vegas_url)
vegas_page
vegas_tbls <-
vegas_page %>%
rvest::html_nodes("table")
vegas_tbls
i = 1
logger::log_info("Vegas tbl {i}")
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table() %>%
dplyr::mutate(homeaway = if_else(row_number() %% 2 == 0, paste0("home_team"), "away_team"))
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
odds_tbl
i = 2
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
i = 5
logger::log_info("Vegas tbl {i}")
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
vegas_tbls
i = 11
logger::log_info("Vegas tbl {i}")
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
i = 4
logger::log_info("Vegas tbl {i}")
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
i = 3
logger::log_info("Vegas tbl {i}")
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
i = 2
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
i = 1
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
i = 2
logger::log_info("Vegas tbl {i}")
odds_tbl <-
vegas_tbls[[i]] %>%
rvest::html_table()
View(odds_tbl)
odds_tbl <-
vegas_tbls[[2]] %>%
rvest::html_table(header = FALSE)
View(odds_tbl)
odds_tbl <-
vegas_tbls[[2]] %>%
rvest::html_table(header = TRUE)
View(odds_tbl)
View(odds_tbl2)
View(odds_tbl)
# vegas_url <- "https://vegas-odds.com/nfl/odds/"
# vegas_url <- "https://sportsbook.draftkings.com/leagues/football/nfl"
vegas_url <- "https://www.rotowire.com/betting/nfl/odds/week-2"
vegas_page <- rvest::read_html(vegas_url)
vegas_page
vegas_tbls <-
vegas_page %>%
rvest::html_nodes("table")
vegas_tbls
odds_tbl <-
vegas_tbls[[2]] %>%
rvest::html_table(header = TRUE)
View(odds_tbl)
odds_tbl <-
vegas_tbls[[1]] %>%
rvest::html_table(header = TRUE)
View(odds_tbl)
vegas_tbls
vegas_page
usethis::use_r("get_week_dates.R")
usethis::use_r("get_vegas.R")
usethis::use_r("get_nfl_teams.R")
devtools::check()
devtools::check()
load_all()
library(devtools)
load_all()
games <- predict_games(year = 2022, week = 1)
get_prob_plot(predictions = games,bar_plot = F, prob_alpha = F, pct_over_coinflip = TRUE)
get_prob_plot(predictions = games, bar_plot = T, prob_alpha = F, pct_over_coinflip = TRUE)
get_prob_plot(predictions = games, bar_plot = T, prob_alpha = T, pct_over_coinflip = TRUE)
get_prob_plot(predictions = games, bar_plot = T, prob_alpha = T, pct_over_coinflip = F)
get_prob_plot(predictions = games, bar_plot = T, prob_alpha = T, pct_over_coinflip = F)
# prediction probabilities plot
game_probs <-
predictions %>%
dplyr::mutate(
probability = dplyr::case_when(
.pred_class == "1" ~ .pred_1,
.pred_class == "0" ~ .pred_0
),
fill        = dplyr::case_when(
.pred_class == "1" ~ "Home win",
.pred_class == "0" ~ "Home loss"
),
winning_team = dplyr::case_when(
.pred_class == "1" ~ home_team,
.pred_class == "0" ~ away_team
),
win_type = dplyr::case_when(
winning_team == home_team ~ "Home win",
winning_team == away_team ~ "Away win"
),
clean_matchup = paste0(away_team, " @ ", home_team)
)
# prediction probabilities plot
games <- predictions
game_probs <-
predictions %>%
dplyr::mutate(
probability = dplyr::case_when(
.pred_class == "1" ~ .pred_1,
.pred_class == "0" ~ .pred_0
),
fill        = dplyr::case_when(
.pred_class == "1" ~ "Home win",
.pred_class == "0" ~ "Home loss"
),
winning_team = dplyr::case_when(
.pred_class == "1" ~ home_team,
.pred_class == "0" ~ away_team
),
win_type = dplyr::case_when(
winning_team == home_team ~ "Home win",
winning_team == away_team ~ "Away win"
),
clean_matchup = paste0(away_team, " @ ", home_team)
)
View(games)
# prediction probabilities plot
predictions <- games
game_probs <-
predictions %>%
dplyr::mutate(
probability = dplyr::case_when(
.pred_class == "1" ~ .pred_1,
.pred_class == "0" ~ .pred_0
),
fill        = dplyr::case_when(
.pred_class == "1" ~ "Home win",
.pred_class == "0" ~ "Home loss"
),
winning_team = dplyr::case_when(
.pred_class == "1" ~ home_team,
.pred_class == "0" ~ away_team
),
win_type = dplyr::case_when(
winning_team == home_team ~ "Home win",
winning_team == away_team ~ "Away win"
),
clean_matchup = paste0(away_team, " @ ", home_team)
)
game_probs
# prediction probabilities plot with probability alpha
game_probs_plot <-
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(winning_team, probability),
fill = win_type,
alpha = probability)
)
# prediction probabilities plot with probability alpha
# game_probs_plot <-
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(winning_team, probability),
fill = win_type,
alpha = probability)
)
load_all()
get_prob_plot(predictions = games, bar_plot = T, prob_alpha = T, pct_over_coinflip = F)
get_prob_plot(predictions = games, bar_plot = T, prob_alpha = T, pct_over_coinflip = T)
game_probs <-
predictions %>%
dplyr::mutate(
probability = dplyr::case_when(
.pred_class == "1" ~ .pred_1,
.pred_class == "0" ~ .pred_0
),
fill        = dplyr::case_when(
.pred_class == "1" ~ "Home win",
.pred_class == "0" ~ "Home loss"
),
winning_team = dplyr::case_when(
.pred_class == "1" ~ home_team,
.pred_class == "0" ~ away_team
),
win_type = dplyr::case_when(
winning_team == home_team ~ "Home win",
winning_team == away_team ~ "Away win"
),
clean_matchup = paste0(away_team, " @ ", home_team)
)
game_probs
game_probs <-
predictions %>%
dplyr::mutate(
probability = dplyr::case_when(
.pred_class == "1" ~ .pred_1,
.pred_class == "0" ~ -1*(.pred_0)
),
fill        = dplyr::case_when(
.pred_class == "1" ~ "Home win",
.pred_class == "0" ~ "Home loss"
),
winning_team = dplyr::case_when(
.pred_class == "1" ~ home_team,
.pred_class == "0" ~ away_team
),
win_type = dplyr::case_when(
winning_team == home_team ~ "Home win",
winning_team == away_team ~ "Away win"
),
clean_matchup = paste0(away_team, " @ ", home_team)
)
game_probs
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = winning_team, label = winning_team),
color = "black", size = 4, hjust = 0, nudge_x = 0.01)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0, nudge_x = 0.01)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0,)
game_probs
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0) + facet_wrap(~win_type)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0) + ggplot2::facet_wrap(~win_type)
game_probs <-
predictions %>%
dplyr::mutate(
probability = dplyr::case_when(
.pred_class == "1" ~ .pred_1,
.pred_class == "0" ~ .pred_0
# .pred_class == "0" ~ -1*(.pred_0)
),
fill        = dplyr::case_when(
.pred_class == "1" ~ "Home win",
.pred_class == "0" ~ "Home loss"
),
winning_team = dplyr::case_when(
.pred_class == "1" ~ home_team,
.pred_class == "0" ~ away_team
),
win_type = dplyr::case_when(
winning_team == home_team ~ "Home win",
winning_team == away_team ~ "Away win"
),
clean_matchup = paste0(away_team, " @ ", home_team)
)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0) + ggplot2::facet_wrap(~win_type)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0) + ggplot2::facet_grid(~win_type)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0) + ggplot2::facet_grid(win_type~.)
game_probs <-
predictions %>%
dplyr::mutate(
probability = dplyr::case_when(
.pred_class == "1" ~ .pred_1 - 0.5,
# .pred_class == "0" ~ .pred_0
.pred_class == "0" ~ -1*(.pred_0) + 0.5
),
fill        = dplyr::case_when(
.pred_class == "1" ~ "Home win",
.pred_class == "0" ~ "Home loss"
),
winning_team = dplyr::case_when(
.pred_class == "1" ~ home_team,
.pred_class == "0" ~ away_team
),
win_type = dplyr::case_when(
winning_team == home_team ~ "Home win",
winning_team == away_team ~ "Away win"
),
clean_matchup = paste0(away_team, " @ ", home_team)
)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0) + ggplot2::facet_grid(win_type~.)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type,
alpha = probability)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0)
game_probs %>%
ggplot2::ggplot() +
ggplot2::geom_col(aes(x = probability,
y = stats::reorder(clean_matchup, probability),
fill = win_type)
)+ ggplot2::geom_text(
ggplot2::aes(x = probability, y = clean_matchup, label = winning_team),
color = "black", size = 4, hjust = 0)
load_all()
get_prob_plot(predictions = games, bar_plot = T, prob_alpha = T, pct_over_coinflip = F)
use_r("make_favored_plot.R")
load_all()
plot_favored(games)
devtools::check()
devtools::check()
load_all()
plot_prob(games)
plot_favored(games)
plot_favored(games, bar_plot = T)
plot_favored(games, prob_alpha = F)
plot_favored(games,pct_over_coinflip = T, prob_alpha = F)
devtools::document()
# Load package
nflpredictr::plot_favored(
predictions = nflpredictr::predict_games(
year = 2022,
week = 1
),
pct_over_coinflip = TRUE
)
# Load package
nflpredictr::plot_favored(
predictions = nflpredictr::predict_games(
year = 2022,
week = 1
),
bar_plot = TRUE,
pct_over_coinflip = TRUE
)
# Load package
nflpredictr::plot_favored(
predictions = nflpredictr::predict_games(
year = 2022,
week = 1
),
bar_plot = TRUE
)
# Load package
nflpredictr::plot_favored(
predictions = nflpredictr::predict_games(
year = 2022,
week = 1
),
bar_plot = FALSE
)
# Load package
nflpredictr::plot_favored(
predictions = nflpredictr::predict_games(
year = 2022,
week = 1
),
bar_plot    = TRUE
)
library(devtools)
devtools::document()
devtools::check()
# Plot the outputs from predict_games()
fav_plot <- nflpredictr::plot_favored(
predictions = nflpredictr::predict_games(
year = 2022,
week = 1
)
)
ggsave(
"man/figures/plot_fav.png",
fav_plot,
heigth = 8,
width = 8
)
ggplot2::ggsave(
"man/figures/plot_fav.png",
fav_plot,
heigth = 8,
width = 8
)
ggplot2::ggsave(
"man/figures/plot_fav.png",
fav_plot,
height  = 8,
width = 8
)
# Plot the outputs from predict_games()
fav_plot <- nflpredictr::plot_favored(
predictions = nflpredictr::predict_games(
year = 2022,
week = 1
),
prob_alpha  = FALSE
)
fav_plot
ggplot2::ggsave(
"man/figures/plot_fav.png",
fav_plot,
height  = 8,
width = 12
)
knitr::knit("README.Rmd", "README.md")
devtools::check()
devtools::check()
devtools::document()
devtools::check()
devtools::document()
devtools::check()
knitr::knit("README.Rmd", "README.md")
